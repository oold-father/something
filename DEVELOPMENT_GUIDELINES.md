# 项目开发准则

> **重要提示**：在进行任何系统设计、代码生成或代码修改前，**必须**阅读并严格遵守本准则。

---

## 1. 项目概述

本准则旨在确保代码质量、一致性和可维护性。所有开发活动都应遵循以下原则。

---

## 2. 核心原则

### 2.1 简约至上 (Simplicity First)
- 优先选择简单直接的解决方案
- 避免过度设计和不必要的抽象
- 清晰优于聪明

### 2.2 可维护性
- 代码应易于理解和修改
- 遵循 DRY 原则 (Don't Repeat Yourself)
- 保持代码与业务逻辑的一致性

### 2.3 可测试性
- 所有核心功能必须有测试覆盖
- 编写可单元测试的代码
- 测试即文档

---

## 3. 编码规范

### 3.1 代码风格
- 使用一致的缩进和格式化
- 使用有意义的变量和函数命名
- 遵循语言特定的最佳实践

### 3.2 函数设计
- 单一职责：每个函数只做一件事
- 保持函数简短：建议不超过 20-30 行
- 参数数量控制在 3-5 个以内

### 3.3 注释规范
- 解释"为什么"而非"是什么"
- 复杂逻辑必须添加注释
- 公共 API 必须有文档注释

### 3.4 错误处理
- 在系统边界（用户输入、外部 API）进行验证
- 使用适当的错误处理机制
- 提供清晰的错误信息

### 3.5 禁止事项
- ❌ 不引入未经验证的安全漏洞
- ❌ 不添加不必要的错误处理和回退机制
- ❌ 不创建一次性使用的辅助函数
- ❌ 不使用 feature flags 或向后兼容的 hack

---

## 4. 系统设计原则

### 4.1 架构决策
- 明确设计目标和约束条件
- 评估不同方案的权衡
- 选择最适合当前需求的技术

### 4.2 模块化设计
- 高内聚、低耦合
- 清晰的模块边界
- 明确的依赖关系

### 4.3 可扩展性
- 预留合理的扩展点
- 避免过度设计
- 支持渐进式演进

### 4.4 性能考虑
- 遵循 YAGNI 原则 (You Aren't Gonna Need It)
- 性能优化应有数据支撑
- 优先考虑算法复杂度

---

## 5. 代码质量标准

### 5.1 代码审查
- 所有代码必须经过审查
- 关注逻辑正确性、代码风格和安全性
- 审查意见必须得到响应

### 5.2 静态分析
- 使用 linter 工具检查代码
- 修复所有警告和错误
- 保持代码健康度高

### 5.3 安全要求
- 遵循 OWASP Top 10 安全指南
- 输入验证和输出编码
- 敏感信息不得硬编码

---

## 6. 测试要求

### 6.1 测试策略
| 测试类型 | 覆盖范围 | 执行时机 |
|---------|---------|---------|
| 单元测试 | 核心逻辑 | 开发中 |
| 集成测试 | 模块交互 | CI/CD |
| 端到端测试 | 关键流程 | 发布前 |

### 6.2 测试原则
- 测试应当快速、独立、可重复
- 使用清晰的测试名称
- 每个测试验证一个行为

---

## 7. 文档规范

### 7.1 代码文档
- 公共接口必须有文档
- 复杂算法需要说明
- 配置选项需要解释

### 7.2 项目文档
- README.md：项目介绍和快速开始
- ARCHITECTURE.md：系统架构说明
- CHANGELOG.md：版本变更记录

---

## 8. 版本控制规范

### 8.1 提交信息
- 使用清晰的提交消息
- 遵循约定式提交格式 (Conventional Commits)
- 单次提交完成一个原子性变更

### 8.2 分支策略
- main/master：生产代码
- develop：开发主分支
- feature/*：功能分支
- fix/*：修复分支

### 8.3 合并规范
- 使用 Pull Request 合并代码
- PR 必须通过所有检查
- 至少一人审查通过

---

## 9. 安全清单

在代码提交前，检查以下事项：

- [ ] 无硬编码的密钥或密码
- [ ] 所有用户输入已验证
- [ ] 无 SQL 注入风险
- [ ] 无 XSS 漏洞
- [ ] 依赖项无已知漏洞
- [ ] 敏感操作有日志记录
- [ ] 错误信息不泄露敏感数据

---

## 10. 性能优化指南

### 10.1 优化原则
- 先测量，后优化
- 优化瓶颈部分
- 权衡空间和时间复杂度

### 10.2 常见优化点
- 数据库查询优化
- 缓存策略
- 异步处理
- 资源压缩

---

## 11. 开发流程

```
1. 阅读本准则 ✓
2. 理解需求 ✓
3. 设计方案 ✓
4. 编写代码 ✓
5. 编写测试 ✓
6. 代码审查 ✓
7. 合并代码 ✓
```

---

## 12. 迭代总结要求

### 12.1 强制要求

**每次完成一个开发迭代后，必须对当前的设计和功能进行总结，并形成文档。**

迭代总结是项目开发的重要环节，确保：

1. 设计决策有迹可循
2. 功能进展清晰可查
3. 问题与解决方案记录在案
4. 下一步计划明确

### 12.2 迭代总结内容

每次迭代完成后，应创建或更新以下内容：

#### 12.2.1 迭代总结文档 (ITERATION_SUMMARY.md)

每个迭代应有独立的总结文档，命名格式：`ITERATION_SUMMARY_v{版本号}.md`

包含以下章节：

```
# 迭代总结 - v{版本号}

> **迭代周期**：YYYY-MM-DD 至 YYYY-MM-DD
> **迭代负责人**：{姓名}

---

## 一、迭代目标

### 1.1 主要目标
- 目标1
- 目标2

### 1.2 预期成果
- 成果1
- 成果2

---

## 二、完成情况

### 2.1 已完成功能
| 功能模块 | 完成度 | 说明 |
|---------|-------|------|
| 模块A | 100% | 已完成 |
| 模块B | 80% | 核心功能完成，待优化 |

### 2.2 技术债务
- [ ] 技术债务1
- [ ] 技术债务2

---

## 三、设计变更

### 3.1 架构变更
| 变更项 | 原设计 | 新设计 | 原因 |
|-------|-------|-------|------|
| 示例 | 原方案A | 新方案B | 原因说明 |

### 3.2 接口变更
| 接口名 | 原签名 | 新签名 | 影响范围 |
|-------|-------|-------|---------|

---

## 四、遇到的问题

### 4.1 技术问题
| 问题描述 | 解决方案 | 状态 |
|---------|---------|------|
| 问题1 | 方案1 | 已解决 |
| 问题2 | 方案2 | 待解决 |

### 4.2 业务问题
（描述需求理解偏差、功能调整等）

---

## 五、测试情况

### 5.1 单元测试
- 覆盖率：XX%
- 用例数：XX 个
- 失败数：XX 个

### 5.2 集成测试
- 场景数：XX 个
- 通过率：XX%

### 5.3 性能测试
| 指标 | 目标值 | 实际值 | 是否达标 |
|-----|-------|-------|---------|
| 指标1 | 值A | 值B | ✓/✗ |

---

## 六、下一步计划

### 6.1 下个迭代目标
- 目标1
- 目标2

### 6.2 待办事项
- [ ] 任务1
- [ ] 任务2

---

## 七、附录

### 7.1 相关文档
- 设计文档链接
- API 文档链接

### 7.2 参考资源
```

#### 12.2.2 更新相关文档

迭代总结完成后，应同步更新以下文档：

| 文档 | 更新内容 |
|-----|---------|
| README.md | 新增功能说明、使用指南更新 |
| DETAILED_DESIGN.md | 设计变更记录 |
| CHANGELOG.md | 版本变更日志 |

### 12.3 迭代总结审核

迭代总结文档需经以下审核流程：

1. **自我审查**：作者检查完整性
2. **技术审核**：技术负责人审核设计变更
3. **产品审核**：产品负责人验收功能完成度

审核通过后，将文档提交到版本控制。

### 12.4 迭代总结模板

快速创建迭代总结的模板文件：

```markdown
# 迭代总结 - v{版本号}

> **迭代周期**：{开始日期} 至 {结束日期}

## 一、迭代目标
### 主要目标
### 预期成果

## 二、完成情况
### 已完成功能
### 技术债务

## 三、设计变更
### 架构变更
### 接口变更

## 四、遇到的问题
### 技术问题
### 业务问题

## 五、测试情况
### 单元测试
### 集成测试
### 性能测试

## 六、下一步计划
### 下个迭代目标
### 待办事项
```

---

---

## 13. 附录

### 13.1 参考资料
- Clean Code (Robert C. Martin)
- The Pragmatic Programmer
- SOLID 原则
- 语言特定最佳实践文档

### 13.2 工具推荐
- 代码格式化：Prettier, Black
- Linter：ESLint, Pylint
- 测试框架：Jest, Pytest
- 文档生成：Sphinx, TypeDoc

---

**最后更新**：2026-02-27

**版本**：1.1.0
